
---


# ğŸ› ï¸ Docker Test Range Setup Guide

## ğŸ“‚ Project Structure

````
network\_emulation/
â”‚
â”œâ”€â”€ docker-compose.yml
â”œâ”€â”€ proxy/
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ entrypoint.sh
â”‚   â””â”€â”€ router.py
â””â”€â”€ client/
â”œâ”€â”€ Dockerfile
â”œâ”€â”€ entrypoint.sh
â””â”€â”€ (captures volume is created automatically)

````

---

## ğŸš€ 1. **Build and Start the Range**
From inside the `network_emulation` directory:

```bash
docker compose up --build
````

* `--build` ensures the latest Dockerfiles are built.
* The first build may take several minutes (especially the client desktop image).

---

## ğŸ”„ 2. **Restarting the Range Quickly**

After the initial build, you can restart without rebuilding:

```bash
docker compose down
docker compose up -d
```

This will use the cached images, starting the environment in seconds.

---

## ğŸŒ 3. **Accessing the Client Desktop**

### noVNC (Browser-based)

* After starting the containers, check the logs for the URL:

  ```
  http://<host-ip>:6901/?password=<auto-generated>
  ```

  On a local machine, use:

  ```
  http://localhost:6901
  ```

* The VNC password is either:

  * Printed in the logs (`?password=...`), or
  * `vncpassword` if you set `VNC_PW` in `docker-compose.yml`.

### VNC Client

* Connect to:

  ```
  localhost:5901
  ```

  with the same password.

---

## ğŸ“¡ 4. **Networking**

* The client routes all traffic through the proxy (`10.200.0.3`).
* The proxy performs transparent forwarding and packet capture on both internal and external interfaces.

---

## ğŸ“œ 5. **Capturing Traffic**

* All packet captures are saved in the `./captures` folder on the host.
* The client and proxy each write timestamped `.pcap` files on startup.

Example:

```
captures/
â”œâ”€â”€ client_traffic_20250726_001200.pcap
â”œâ”€â”€ proxy_traffic_eth0_20250726_001200.pcap
â””â”€â”€ proxy_traffic_eth1_20250726_001200.pcap
```

---

## ğŸ“ 6. **Getting Files Out of the Client**

* Any file saved to `/captures` inside the client appears in `./captures` on the host.
* You can also use `docker cp`:

  ```bash
  docker cp network_emulation-client-1:/path/to/file ./file
  ```

---

## ğŸ§¹ 7. **Cleaning Up**

To remove all containers, networks, and volumes:

```bash
docker compose down -v
```

To rebuild from scratch (including images):

```bash
docker compose down -v --rmi all
```

---

## âœ… 8. **Quick Commands Cheat Sheet**

* **Start and build:**

  ```bash
  docker compose up --build
  ```

* **Stop:**

  ```bash
  docker compose down
  ```

* **Check logs:**

  ```bash
  docker compose logs client
  docker compose logs proxy
  ```

* **Copy files:**

  ```bash
  docker cp network_emulation-client-1:/captures ./captures_backup
  ```


## ğŸ” 9. **Setting a Custom VNC Password**

In `docker-compose.yml`, under the client service:

```yaml
environment:
  - VNC_PW=password
```

Rebuild:

```bash
docker compose up --build
```

Now `password` is used instead of the auto-generated one.




Would you also like me to include an **ASCII network diagram** showing `client â†’ proxy â†’ internet` inside this guide for clarity?
